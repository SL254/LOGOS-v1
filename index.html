<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <title>LOGOS ORGANON</title>
    <style>
      body {
        background-color: #000;
        margin: 0;
        overflow: hidden;
      }

      /* 추가된 부분: 시각/상호작용 계층을 겹치기 위한 스타일 */
      #render-wrapper {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 1920px;
        height: 1080px;
        border: none;
        /* transform-origin은 JS에서 설정합니다. */
      }

      #visual-canvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        /* 상호작용 계층 아래에 위치 */
        z-index: 1;
      }

      #game-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: none;
        /* 시각 계층 위에 위치하며, 상호작용을 담당 */
        z-index: 2;
        opacity: 0;
      }
      /* --- */

      #game-container iframe {
        width: 100%;
        height: 100%;
        border: none;
      }
    </style>
  </head>
  <body>
    <div id="render-wrapper">
      <canvas id="visual-canvas" width="1920" height="1080"></canvas>
      <div id="game-container">
        <iframe src="game.html" id="game-iframe"></iframe>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@zumer/snapdom/dist/snapdom.min.js"></script>

    <script src="snapdom-renderer.js"></script>

    <script>
      const renderWrapper = document.getElementById("render-wrapper"); // game-container -> render-wrapper
      const DESIGN_WIDTH = 1920;
      const DESIGN_HEIGHT = 1080;

      function resizeGame() {
        const viewportWidth = window.innerWidth;
        const viewportHeight = window.innerHeight;

        const scaleX = viewportWidth / DESIGN_WIDTH;
        const scaleY = viewportHeight / DESIGN_HEIGHT;

        const scale = Math.min(scaleX, scaleY);

        // render-wrapper의 transform 속성을 변경합니다.
        renderWrapper.style.transform = `translate(-50%, -50%) scale(${scale})`;
      }

      window.addEventListener("DOMContentLoaded", resizeGame);
      window.addEventListener("resize", resizeGame);

      window.addEventListener("message", (event) => {
        if (event.data === "toggle-fullscreen") {
          if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
          } else {
            document.exitFullscreen();
          }
        }
      });
    </script>
  </body>
</html>
